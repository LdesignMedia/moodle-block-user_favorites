/**
 * Tested in Moodle 3.5
 *
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 *
 * @copyright 2018 MFreak.nl
 * @author    Luuk Verhoeven
 **/
define("block_user_favorites/favorites",["jquery","core/ajax","core/notification","core/log","jqueryui"],(function($,Ajax,Notification,Log){let opts={debugjs:!0,id:0,url:"",hash:""};const favoritesModule={setUrl:function(data,title){Notification.confirm(M.util.get_string("javascript:set_title","block_user_favorites"),'<input class="form-control" id="favorite-url" value="'+title+'">',M.util.get_string("javascript:yes","block_user_favorites"),M.util.get_string("javascript:no","block_user_favorites"),(function(){Ajax.call([{methodname:"block_user_favorites_set_url",args:{hash:data.hash,optional:{url:data.url},title:$("#favorite-url").val(),blockid:opts.id}}])[0].done((function(response){Log.log(response),favoritesModule.reload()})).fail(Notification.exception)}))},setOrder:function(){$("ol#block_user_favorites-items li").each((function(index){Ajax.call([{methodname:"block_user_favorites_set_order",args:{hash:$(this).data("hash"),sortorder:index}}])}))},remove:function(data){Ajax.call([{methodname:"block_user_favorites_delete_url",args:{hash:data.hash,blockid:opts.id}}])[0].done((function(response){Log.log(response),favoritesModule.reload()})).fail(Notification.exception)},reload:function(){Ajax.call([{methodname:"block_user_favorites_content",args:{url:opts.url,blockid:opts.id}}])[0].done((function(response){Log.log(response),$(".block_user_favorites .content").html(response.content),$("ol#block_user_favorites-items").sortable({update:function(){favoritesModule.setOrder()}})})).fail(Notification.exception)},init:function(){Log.log("Init block_user_favorites"),$(".block_user_favorites").on("click","#block_user_favorites_set",(function(){favoritesModule.setUrl({hash:opts.hash,url:window.location.href},$("title").text())})).on("click","#block_user_favorites_delete",(function(){favoritesModule.remove({hash:opts.hash})})).on("click",".fa-remove",(function(){favoritesModule.remove($(this).closest("li").data())})).on("click",".fa-edit",(function(){let data=$(this).parent().parent().data();data.url=null,favoritesModule.setUrl(data,$(this).parent().parent().find("a").text())})),$("ol#block_user_favorites-items").sortable({update:function(){favoritesModule.setOrder()}})}};return{initialise:function(args){!function(options){let key,vartype;for(key in opts)opts.hasOwnProperty(key)&&options.hasOwnProperty(key)&&(vartype=typeof opts[key],"boolean"===vartype?opts[key]=Boolean(options[key]):"number"===vartype?opts[key]=Number(options[key]):"string"===vartype&&(opts[key]=String(options[key])))}(args),Log.log(opts.debugjs),$.noConflict(),$(document).ready((function(){Log.log("Block User Favorites v1.2"),favoritesModule.init()}))}}}));

//# sourceMappingURL=favorites.min.js.map